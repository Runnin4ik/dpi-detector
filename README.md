# üîç DPI Detector

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å–∞–π—Ç–æ–≤/CDN/—Ö–æ—Å—Ç–∏–Ω–≥-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ —É —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤.

> ‚≠ê –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –ø–æ–ª–µ–∑–µ–Ω, –ø–æ—Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥—É!

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Docker](https://img.shields.io/badge/docker-ready-brightgreen.svg)](https://github.com/Runnin4ik/dpi-detector/pkgs/container/dpi-detector)

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ê–Ω–∞–ª–∏–∑ TLS** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã TLS 1.2 –∏ TLS 1.3, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–º–µ–Ω—ã —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ (MITM) –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ SNI
- ‚úÖ **HTTP Injection –¥–µ—Ç–µ–∫—Ç–æ—Ä** - –Ω–∞—Ö–æ–¥–∏—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –Ω–∞ –±–ª–æ–∫-—Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- ‚úÖ **TCP 16-20KB –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** - –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –æ–±—Ä—ã–≤ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ–¥–∞—á–∏ 14-34KB
- ‚úÖ **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫** - TCP Reset (RST), Connection Abort, Handshake/Read Timeout, TLS alerts, SNI blocking, MITM (–ø–æ–¥–º–µ–Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞), HTTP 451 –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ IPv4-only —Ä–µ–∂–∏–º–∞** - –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –æ—Ç IPv6

## Docker

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç –æ–±—Ä–∞–∑ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫—É. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è!
```bash
docker run --rm -it ghcr.io/runnin4ik/dpi-detector:latest
```

#### –° –∫–∞—Å—Ç–æ–º–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª—ã: domains.txt, tcp_16_20_targets.json –∏–ª–∏ config.py
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º (–º–æ–∂–Ω–æ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤)
docker run --rm -it \
  -v $(pwd)/domains.txt:/app/domains.txt \
  -v $(pwd)/tcp_16_20_targets.json:/app/tcp_16_20_targets.json \
  -v $(pwd)/config.py:/app/config.py \
  ghcr.io/runnin4ik/dpi-detector:latest
```

## Python
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Python 3.8+
- pip
- httpx>=0.28.1
- rich>=14.3.2

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
git clone https://github.com/Runnin4ik/dpi-detector.git
cd dpi-detector
pip install -r requirements.txt
```

**–ó–∞–ø—É—Å–∫:**
```bash
python dpi_detector.py
```

## ü™ü Windows
–î–ª—è —Ç–µ—Ö –∫—Ç–æ –Ω–µ —Ö–æ—á–µ—Ç —Å—Ç–∞–≤–∏—Ç—å —Å–µ–±–µ python –∫ –∫–∞–∂–¥–æ–º—É —Ä–µ–ª–∏–∑—É –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω [.exe —Ñ–∞–π–ª](https://github.com/Runnin4ik/dpi-detector/releases/download/v1.0.0/dpi_detector.exe)

## –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è:
```bash
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ domains.txt –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–≤–æ–∏—Ö –¥–æ–º–µ–Ω–æ–≤
domains.txt
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ tcp_16_20_targets.json –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–≤–æ–∏—Ö –¥–æ–º–µ–Ω–æ–≤ TCP 16-20KB –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
tcp_16_20_targets.json
# –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config.py (—Ç–∞–π–º–∞—É—Ç—ã, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤ –∏ —Ç.–¥.)
config.py
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Ç–∫—Ä–æ–π—Ç–µ `dpi_detector.py` –∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞:
```python
# === –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ===
USE_IPV4_ONLY = True              # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ IPv4 (–æ—Ç–∫–ª—é—á–∏—Ç—å IPv6)
MAX_CONCURRENT = 150              # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

# === –¢–∞–π–º–∞—É—Ç—ã ===
TIMEOUT = 6.0                     # –¢–∞–π–º–∞—É—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–º–µ–Ω–æ–≤ (—Å–µ–∫)
TIMEOUT_TCP_16_20 = 12.0          # –¢–∞–π–º–∞—É—Ç –¥–ª—è TCP 16-20KB —Ç–µ—Å—Ç–∞ (—Å–µ–∫)

# === –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ ===
DOMAIN_CHECK_RETRIES = 1          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è –¥–æ–º–µ–Ω–æ–≤
TCP_16_20_CHECK_RETRIES = 1       # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è TCP —Ç–µ—Å—Ç–∞

# === TCP –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ ===
TCP_BLOCK_MIN_KB = 4              # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –¥–µ—Ç–µ–∫—Ç–∞ TCP –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (KB)
TCP_BLOCK_MAX_KB = 60             # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –¥–µ—Ç–µ–∫—Ç–∞ TCP –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (KB)
```

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç
–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è Issue –∏ Pull Request'—ã!

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

[MIT License](LICENSE) ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ.

## ‚ö†Ô∏è –î–∏—Å–∫–ª–µ–π–º–µ—Ä

–≠—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–µ–ª–µ–π. –ê–≤—Ç–æ—Ä –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω–æ–≥–æ –ü–û.

## üôè –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

- –í–¥–æ—Ö–Ω–æ–≤–ª–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–º [hyperion-cs/dpi-checkers](https://github.com/hyperion-cs/dpi-checkers) –∏ —á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –µ–≥–æ –¥–æ–º–µ–Ω—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ TCP16-20 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫